---
title: "構造的因果モデルの基礎 輪読 ＃1"
subtitle: "第1章 はじめに"
author: "谷口友哉"
date: "`r format(Sys.time(),'%Y/%m/%d')`"
output:
  revealjs::revealjs_presentation:
    df_print: "paged"
    css: "for_revealjs.css"
    self_contained: true
#    transition: convex
    theme: sky
    highlight: kate
    center: true
    reveal_plugins: ['chalkboard']
    
    reveal_options:
      slideNumber: 'c/t'
      chalkboard:
        theme: whiteboard
pandoc_args: [
      '--from', 'markdown+autolink_bare_uris+tex_math_single_backslash-implicit_figures'
    ]
---

## 1章のまとめ {#summary}




# 1.1 背景

## 現実社会において

* 興味ある現象の因果関係を明らかにし、それに従い行動を選択する場面にしばしば遭遇
* この時実質科学の諸分野のニーズに応え得る記述表現で十分
* 例えば、興味ある行動をとったときの実際に取ったときにどのような結果が生じるか(因果効果 : causal effect)を知りたいなら,そのことが定量的かつ合理的に評価できるもので十分
* ゆえに、時には過剰なほど慎重な態度で因果関係の解析に臨み、大胆な態度で因果関係を簡略化して記述しようとする

## 実際問題

* 興味ある現象に関係する事柄は数多く存在し,複雑に絡み合っている.
* よって,原因を突き止めたり,因果関係を明らかにしたり,興味ある行動をとったときに何が起こるのかを予測することは簡単ではない.
* それゆえ因果関係に関わる多くの問題を解決することは,実質科学における主要な研究目的の一つ.

## ランダム化実験(randomized experiment)

* 因果関係に関わる多くの問題を解決するための主力な方法論
* コスト面、技術面、倫理面などの理由から困難なケースも多い
* 人為的な操作が加えられていない現象を観察し、そこから因果関係を推論
* このような活動を**介入 (外的操作) **を伴わない**観察研究に基づく因果推論 (causal inference)**、あるいは単に観察研究に基づく因果推論という

## 因果関係に関わる問題を解決するには

* 興味ある現象を多角的に検討することが不可欠
  * 先人たちの「因果とは何か？」という問い
  * 複数の研究領域を通じて分野横断的に議論されてきた
* データという強力なエビデンスを研究対象とする統計科学は因果関係を取り巻く様々な問題を解決する有力なツールとして広く用いられている

## 統計科学における因果推論

* *The Grammar of  Sience*' (Pearson,1911) 第6章において、
"No phenomena are causal..." と述べて以来、因果関係の概念が排除された状態が続く
* 実験計画法 (Fisher,1935) を除いて、相関関係だけでは立証することのできない因果関係が数理統計学の範疇で議論されることはほぼなかった
  * ランダム割り付けという因果関係に基づいて定義される概念が導入
* その他の数理統計学では、ランダム割り付けなどの特別な因果仮定を必要としない
* 確率論に因果関係を記述するツールが存在しなかった

## 一方、医学・工学・社会科学の分野では

* 観察データと専門知識を融合させた因果推論が数多く行われてきた
* しかし統計手法の誤用も多く見られる
  * 例：品質管理の分野
  * 操業データにおいて要因と特性（反応）の区別がなされている時、回帰分析による因果効果の推定を行い、品質特性を予測、制御、調節
  * このような統計解析では要因間の因果関係が明示的にモデル化や定式化されることは少ない

## 要因間に相関関係が認められる時

* 相関関係が
  (1) 2つの要因間の因果関係によって生じたのか
  (2) 2つの要因の共通原因となる第3の要因が存在し,その要因の変動によって生じたのか
  を検討せず行った解析結果は、大きな誤りを導く可能性があることが指摘

# 1.2 有効グラフを用いた因果推論

## パス解析(path analysis) Wright,1921

* 定性的因果仮説を積極的に解析へ取り入れ、因果効果を定量的に評価するための有力な方法論
* 遺伝学の分野で開発
* 構造方程式モデル(structural equation model;SEM) Wold,1954 として計量経済学の分野で発展
* 特徴
  (1) パスダイアグラム(path diagram)による定性的因果仮説の視覚表現
  (2) パス係数(path coefficient)による変数間の相関の分解
  (3) 直接効果(direct effect)と総合効果(total effect)の区別

* 変数間の因果関係がパスダイアグラムという有向グラフ(directed graph) および線形構造方程式モデル(linear SEM) によって正しく記述されているとき,相関情報に基づいて直接効果や総合効果を定量的に推論する方法論

## パス解析における総合効果と直接効果

* XからYへの総合効果
  * 共変量(covariate)を全て一定の値に固定したうえで、外的操作(intervention manipulation)により、Xの値を一単位変化させた時のYの期待値の変化量
* XからYへの直接効果
  * Yの影響を受けない変数のうちXを除いたものを外的操作によって全て一定の値に固定したうえで、外的操作によりXの値を一単位変化させた時のYの期待値の変化量

* 共変量：XやYの影響を受けない変数
* 外的操作によりXの値を一単位変化させる：共変量がとる値とは無関係にXの値を一単位変化させること(詳しくは第5.3節)
* (筆者の知る限り)直接効果や総合効果にこのような解釈を明示的に与えたのはPearl(1998)

##  有向グラフを用いた因果推論のフレームワークにおける仮定(Pearl,2009a)

* (1) 因果関係は,有効グラフ上に記述される変数,有効グラフ上には現れないもののグラフ上にある変数の挙動を規定する錯乱項 (random disturbance),そしてデータ生成過程 (data generating process) を表現した構造方程式モデルに基づいて記述される
* (2) 構造方程式モデルに含まれる構造方程式のいくつかが構造的に変化したとしても,それらの変化がその他の構造方程式の構造に影響を与えることはない.この条件を満たす構造方程式モデルは自律的 (autonomous) であると呼ばれる.
* 自律的構造方程式モデルこそ,Pearlが提案した構造的因果モデル(structural causal model;SCM)

# 1.3 Neyman-Rubinの因果モデル




# 1.4 相関関係か？因果関係か？

## 1.4.1 チョコレートとノーベル賞

# 1.5 問題意識




