<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="谷口友哉" />
  <title>構造的因果モデルの基礎 輪読 ＃1</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Kuroki_01_files/reveal.js-3.3.0.1/css/reveal.css"/>



<link rel="stylesheet" href="Kuroki_01_files/reveal.js-3.3.0.1/css/theme/sky.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>

    <link rel="stylesheet" href="for-revealjs.css"/>

<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

    <link href="Kuroki_01_files/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
    <link href="Kuroki_01_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section>
    <h1 class="title">構造的因果モデルの基礎 輪読 ＃1</h1>
  <h1 class="subtitle">第1章 はじめに</h1>
    <h2 class="author">谷口友哉</h2>
    <h3 class="date">2020/07/09</h3>
</section>

<section><section id="背景" class="title-slide slide level1"><h1>1.1 背景</h1></section><section id="現実社会において" class="slide level2">
<h2>現実社会において</h2>
<ul>
<li>興味ある現象の因果関係を明らかにし、それに従い行動を選択する場面にしばしば遭遇</li>
<li>この時実質科学の諸分野のニーズに応え得る記述表現で十分</li>
<li>例えば、興味ある行動をとったときの実際に取ったときにどのような結果が生じるか(因果効果 : causal effect)を知りたいなら,そのことが定量的かつ合理的に評価できるもので十分</li>
<li>ゆえに、時には過剰なほど慎重な態度で因果関係の解析に臨み、大胆な態度で因果関係を簡略化して記述しようとする</li>
</ul>
</section><section id="実際問題" class="slide level2">
<h2>実際問題</h2>
<ul>
<li>興味ある現象に関係する事柄は数多く存在し,複雑に絡み合っている.</li>
<li>よって,原因を突き止めたり,因果関係を明らかにしたり,興味ある行動をとったときに何が起こるのかを予測することは簡単ではない.</li>
<li>それゆえ因果関係に関わる多くの問題を解決することは,実質科学における主要な研究目的の一つ.</li>
</ul>
</section><section id="ランダム化実験randomized-experiment" class="slide level2">
<h2>ランダム化実験(randomized experiment)</h2>
<ul>
<li>因果関係に関わる多くの問題を解決するための主力な方法論</li>
<li>コスト面、技術面、倫理面などの理由から困難なケースも多い</li>
<li>人為的な操作が加えられていない現象を観察し、そこから因果関係を推論</li>
<li>このような活動を<strong>介入 (外的操作) </strong>を伴わない<strong>観察研究に基づく因果推論 (causal inference)</strong>、あるいは単に観察研究に基づく因果推論という</li>
</ul>
</section><section id="因果関係に関わる問題を解決するには" class="slide level2">
<h2>因果関係に関わる問題を解決するには</h2>
<ul>
<li>興味ある現象を多角的に検討することが不可欠
<ul>
<li>先人たちの「因果とは何か？」という問い</li>
<li>複数の研究領域を通じて分野横断的に議論されてきた</li>
</ul></li>
<li>データという強力なエビデンスを研究対象とする統計科学は因果関係を取り巻く様々な問題を解決する有力なツールとして広く用いられている</li>
</ul>
</section><section id="統計科学における因果推論" class="slide level2">
<h2>統計科学における因果推論</h2>
<ul>
<li><em>The Grammar of Sience</em>’ (Pearson,1911) 第6章において、 “No phenomena are causal…” と述べて以来、因果関係の概念が排除された状態が続く</li>
<li>実験計画法 (Fisher,1935) を除いて、相関関係だけでは立証することのできない因果関係が数理統計学の範疇で議論されることはほぼなかった
<ul>
<li>ランダム割り付けという因果関係に基づいて定義される概念が導入</li>
</ul></li>
<li>その他の数理統計学では、ランダム割り付けなどの特別な因果仮定を必要としない</li>
<li>確率論に因果関係を記述するツールが存在しなかった</li>
</ul>
</section><section id="一方医学工学社会科学の分野では" class="slide level2">
<h2>一方、医学・工学・社会科学の分野では</h2>
<ul>
<li>観察データと専門知識を融合させた因果推論が数多く行われてきた</li>
<li>しかし統計手法の誤用も多く見られる
<ul>
<li>例：品質管理の分野</li>
<li>操業データにおいて要因と特性（反応）の区別がなされている時、回帰分析による因果効果の推定を行い、品質特性を予測、制御、調節</li>
<li>このような統計解析では要因間の因果関係が明示的にモデル化や定式化されることは少ない</li>
</ul></li>
</ul>
</section><section id="要因間に相関関係が認められる時" class="slide level2">
<h2>要因間に相関関係が認められる時</h2>
<ul>
<li>相関関係が
<ol type="1">
<li>2つの要因間の因果関係によって生じたのか</li>
<li>2つの要因の共通原因となる第3の要因が存在し,その要因の変動によって生じたのか を検討せず行った解析結果は、大きな誤りを導く可能性があることが指摘</li>
</ol></li>
</ul>
</section></section>
<section><section id="有効グラフを用いた因果推論" class="title-slide slide level1"><h1>1.2 有効グラフを用いた因果推論</h1></section><section id="パス解析path-analysis-wright1921" class="slide level2">
<h2>パス解析(path analysis) Wright,1921</h2>
<ul>
<li>定性的因果仮説を積極的に解析へ取り入れ、因果効果を定量的に評価するための有力な方法論</li>
<li>遺伝学の分野で開発</li>
<li>構造方程式モデル(structural equation model;SEM) Wold,1954 として計量経済学の分野で発展</li>
<li>特徴
<ol type="1">
<li>パスダイアグラム(path diagram)による定性的因果仮説の視覚表現</li>
<li>パス係数(path coefficient)による変数間の相関の分解</li>
<li>直接効果(direct effect)と総合効果(total effect)の区別</li>
</ol></li>
<li>変数間の因果関係がパスダイアグラムという有向グラフ(directed graph) および線形構造方程式モデル(linear SEM) によって正しく記述されているとき,相関情報に基づいて直接効果や総合効果を定量的に推論する方法論</li>
</ul>
</section><section id="パス解析における総合効果と直接効果" class="slide level2">
<h2>パス解析における総合効果と直接効果</h2>
<ul>
<li>XからYへの総合効果
<div class="box">
<p>共変量(covariate)を全て一定の値に固定したうえで、外的操作(intervention manipulation)により、Xの値を一単位変化させた時のYの期待値の変化量</p>
</div></li>
<li>XからYへの直接効果
<div class="box">
<p>Yの影響を受けない変数のうちXを除いたものを外的操作によって全て一定の値に固定したうえで、外的操作によりXの値を一単位変化させた時のYの期待値の変化量</p>
</div></li>
<li>共変量：XやYの影響を受けない変数</li>
<li>外的操作によりXの値を一単位変化させる：共変量がとる値とは無関係にXの値を一単位変化させること(詳しくは第5.3節)</li>
<li>(筆者の知る限り)直接効果や総合効果にこのような解釈を明示的に与えたのはPearl(1998)</li>
</ul>
</section><section id="グラフィカルモデルの出現" class="slide level2">
<h2>グラフィカルモデルの出現</h2>
</section><section id="有向グラフを用いた因果推論のフレームワークにおける仮定pearl2009a" class="slide level2">
<h2>有向グラフを用いた因果推論のフレームワークにおける仮定(Pearl,2009a)</h2>
<ul>
<li><ol type="1">
<li>因果関係は,有効グラフ上に記述される変数,有効グラフ上には現れないもののグラフ上にある変数の挙動を規定する錯乱項 (random disturbance),そしてデータ生成過程 (data generating process) を表現した構造方程式モデルに基づいて記述される</li>
</ol></li>
<li><ol start="2" type="1">
<li>構造方程式モデルに含まれる構造方程式のいくつかが構造的に変化したとしても,それらの変化がその他の構造方程式の構造に影響を与えることはない.この条件を満たす構造方程式モデルは自律的 (autonomous) であると呼ばれる.</li>
</ol></li>
<li>自律的構造方程式モデルこそ,Pearlが提案した構造的因果モデル(structural causal model;SCM)</li>
</ul>
</section><section id="統計科学と有効グラフにおける誤差項" class="slide level2">
<h2>統計科学と有効グラフにおける誤差項</h2>
</section><section id="パス解析と構造的因果モデル" class="slide level2">
<h2>パス解析と構造的因果モデル</h2>
</section><section id="生成generationとは" class="slide level2">
<h2>生成(generation)とは</h2>
</section><section id="データ生成の例" class="slide level2">
<h2>データ生成の例</h2>
</section></section>
<section><section id="neyman-rubinの因果モデル" class="title-slide slide level1"><h1>1.3 Neyman-Rubinの因果モデル</h1></section><section id="潜在反応モデルpotential-outcome-model" class="slide level2">
<h2>潜在反応モデル(potential outcome model)</h2>
<ul>
<li>Neymanによる潜在反応モデル
<ul>
<li>パス解析と同時期に提案</li>
<li>各個体はそれぞれ割り当てられるであろう処理に対応する<br />
潜在的な反応を持つ</li>
<li>割り当てられた処理に応じて個体の反応が観測</li>
<li>ランダム化実験に限定した議論(Rubin 2005)</li>
</ul></li>
<li>Rubinによる潜在反応モデル
<ul>
<li>欠測メカニズムと結びつけ、フレームワークを実験研究から<br />
観察研究へと拡張</li>
</ul></li>
</ul>
</section><section id="潜在反応モデルに基づく因果推論の特徴" class="slide level2">
<h2>潜在反応モデルに基づく因果推論の特徴</h2>
<div class="box">
<p>各個体のそれぞれにおいて、ある処理を受けた時の<br />
反応とその処理を受けなかった時の反応の両方が<br />
観察できるのであれば、それらを比較することで<br />
個体レベルでの因果効果が定量的に評価できる</p>
</div>
<ul>
<li>実際には片方の反応しか観測されない</li>
<li>何の因果仮定を置かないまま、データから個体レベルの因果効果を定量的に比較できない:<strong>因果推論の基本問題</strong> (Holland 1986)</li>
<li>原則個体レベルの因果効果を評価せず、集団レベルの<br />
因果効果（population level causal effect）を評価</li>
</ul>
</section><section id="sutvastable-unit-treatment-value-assumption" class="slide level2">
<h2>SUTVA(Stable Unit Treatment Value Assumption)</h2>
<ul>
<li>集団レベルの因果効果の定量的評価は<strong>SUTVA</strong>という<br />
仮定（Runbin,1980,1986）に基づいて議論</li>
</ul>
<div class="box">
<ol type="1">
<li>No Interference between Units</li>
</ol>
<ul>
<li>興味ある処理を受けた時に観測される個体の反応は、他の個体がどのような処理を受けようともその影響を受けない</li>
</ul>
<ol start="2" type="1">
<li>No Multiple Versions of Treatment</li>
</ol>
<ul>
<li>処理水準(level) (処理変数がとる値や条件)は<br />
それぞれ一意に定義される</li>
</ul>
</div>
<ul>
<li>(1)の解析対象
<ul>
<li>個体が独立で同一分布からサンプリング、あるいはそれに<br />
相当するデータ（例：ランダムサンプリング）</li>
</ul></li>
</ul>
</section><section id="適切にランダムサンプリングされている時" class="slide level2">
<h2>適切にランダムサンプリングされている時</h2>
<ul>
<li>ある個体が選ばれたかは他の個体が選ばれたかと無関係</li>
<li>他の個体が受ける処理や潜在的な反応とも無関係</li>
<li>このような状況では、No Interference between Unitsの仮定が成り立つと考える</li>
<li>適切にランダムサンプリングされていない場合、<br />
No Interference between Unitsの仮定の妥当性を<br />
高めることは難しい
<ul>
<li>外生性という仮定の妥当性を高める方法は<br />
ランダム化実験以外では難しいこととほぼ同じ(詳細は第6.5節)</li>
</ul></li>
</ul>
</section><section id="実際の運用上の問題" class="slide level2">
<h2>実際の運用上の問題</h2>
<ul>
<li>ランダムサンプリングが行われていても、即座に<br />
No Interference between Unitsが成り立つと<br />
判断できるわけではない
<ul>
<li>偶発性により、偏ったデータが採取</li>
<li>個体どうしの接触回数の多い環境のなかでのサンプリング</li>
<li>集団の代表性を保証するのが困難であるケース</li>
</ul></li>
<li>できる限り偏りが排除された様々な集団に基づき、<br />
解析結果の一様性や非一様性を確認しながら<br />
一般化可能性(詳細は第3.4節)を検討</li>
<li><strong>単一の研究に基づく解析結果に囚われると、</strong><br />
<strong>因果関係に関する判断を見誤る可能性がある</strong></li>
</ul>
</section><section id="例ワクチンの効果を調べる観察研究" class="slide level2">
<h2>例：ワクチンの効果を調べる観察研究</h2>
<ul>
<li>ワクチンを接種すると個体Aが感染症にかかりにくく<br />
なるかは、個体Aとの接触が多い個体Bがすでに<br />
ワクチンを接種しているかに依存</li>
<li>個体Bがすでにワクチンを接種している
<ul>
<li>個体Bが感染症にかかりにくくなるため、<br />
個体Aが感染症にかかる可能性も小さくなる</li>
</ul></li>
<li>個体Bがワクチンを接種していない
<ul>
<li>個体Aは感染症にかかりやすくなる</li>
</ul></li>
<li>感染症への曝露状況が異なると一般にワクチンの効果の大きさも異なる
<ul>
<li>個体Aに対するワクチン接種の反応が個体Bがワクチンを<br />
接種したかに依存する可能性を示唆</li>
<li>個体間の接触が頻繁に起こるような特定地域で<br />
ランダムサンプリングを行っても、<br />
No Interference between Unitsの仮定を正当化することは困難</li>
</ul></li>
</ul>
</section><section id="no-multiple-versions-of-treatment" class="slide level2">
<h2>No Multiple Versions of Treatment</h2>
<div class="box">
<ul>
<li>処理水準のそれぞれに対して、割り当てられた<br />
処理水準内においては異質性が存在しないことを示唆</li>
</ul>
</div>
<ul>
<li>例えば
<ul>
<li>データ解析の際、連続変数である処理を離散化</li>
<li>複数のカテゴリの離散変数である処理を１つに要約</li>
</ul></li>
<li>同一カテゴリに含まれる値は区別されないため、<br />
No Multiple Versions of Treatmentの仮定が<br />
正当化されない可能性</li>
</ul>
</section><section id="例治療の有無による疾患への影響を調査" class="slide level2">
<h2>例：治療の有無による疾患への影響を調査</h2>
<ul>
<li>一言に「治療」と言っても
<ul>
<li>薬物治療、外科治療</li>
<li>薬物治療にも使われる薬剤は様々</li>
<li>同じ薬剤でも用量が異なる</li>
</ul></li>
<li>様々な治療があり、治療の質は異なる</li>
<li>「治療」に No Multiple Versions of Treatmentを<br />
仮定すると、全て「治療」という一言で定義され、<br />
治療の質による違いが考慮されない</li>
</ul>
</section><section id="一致性consistency" class="slide level2">
<h2>一致性(consistency)</h2>
<div class="box">
<p>個体が興味ある処理を受けたときに生じるであろう<br />
反応が、実際に処理を受けたときに観測されることを<br />
数学的に表現したもの<br />
個体について観測される反応と潜在的な反応を<br />
結びつける重要な鍵</p>
</div>
<ul>
<li>SUTVAに基づいて定義される概念</li>
</ul>
</section><section id="scmと比較した潜在反応モデル" class="slide level2">
<h2>SCMと比較した潜在反応モデル</h2>
<ul>
<li>潜在反応モデルは
<ul>
<li>処理の割付メカニズムにアイデアの源泉</li>
<li>欠測値データの解析法を数理基盤</li>
<li>有向グラフを用いた因果推論と比較して、<br />
実務家には扱いやすい</li>
</ul></li>
<li>一方SUTVAと一致性の仮定を通して、
<ul>
<li>観測される反応に基づいて潜在的な反応が定義</li>
<li>潜在的な反応自身に独立な定義はない</li>
</ul></li>
<li>筆者の知る限り、以下の問題への明確な答えは<br />
与えられていない(Pearl,2010a)
<ul>
<li>そもそも潜在的な反応はどのように生成されたか</li>
<li>一致性が成立しないときの潜在的な反応とは何か</li>
</ul></li>
</ul>
</section><section id="潜在反応モデルと比較したscm" class="slide level2">
<h2>潜在反応モデルと比較したSCM</h2>
<ul>
<li>一方SCMのフレームワークの場合、潜在的な反応は<br />
データ生成過程と結びつけて定式化
<ul>
<li>No Multiple Versions of Treatmentや一致性について仮定する必要なし</li>
<li>むしろデータ生成過程が持つ性質として導かれる</li>
</ul></li>
</ul>
</section><section id="因果効果の定量的評価問題" class="slide level2">
<h2>因果効果の定量的評価問題</h2>
<ul>
<li>SCMと潜在反応モデルの立場は異なる
<ul>
<li>どちらの立場でも、因果効果を定量的に評価するために適切な共変量を選択されることが重要視</li>
</ul></li>
<li>潜在反応モデルでは、
<ul>
<li>要因間の因果関係をモデル化することを極力避ける工夫</li>
<li>共変量選択問題が詳細に議論されることは少ない
<ul>
<li>シミュレーション評価や感度分析、傾向スコアなどで議論される共変量選択基準の多くは経験的や統計的</li>
<li>因果効果を評価するために十分な共変量の選択を客観的に判断しにくい</li>
</ul></li>
</ul></li>
<li>一方SCMでは、
<ul>
<li>必要に応じて要因間の因果関係もモデル化される</li>
<li>データ生成過程の観点に基づき、客観的な共変量選択基準を<br />
与えることが可能</li>
<li>データ生成過程の考え方は計算アルゴリズムと相性が良い
<ul>
<li>SCMは情報科学や工学の分野の研究者が因果関係を考える上で<br />
有効なツール(たとえば、清水,2017)</li>
</ul></li>
</ul></li>
</ul>
</section></section>
<section><section id="相関関係か因果関係か" class="title-slide slide level1"><h1>1.4 相関関係か？因果関係か？</h1></section><section id="チョコレートとノーベル賞" class="slide level2">
<h2>1.4.1 チョコレートとノーベル賞</h2>
<ul>
<li>国民1人当たりチョコ年間消費量と、国民100万人当たり<br />
ノーベル賞受賞者数に関する解析事例(Messerli,2012)</li>
<li>フラバノールを豊富に含むチョコの消費量を取り上げ、「国レベルのチョコ消費量」と国民の認知機能の間に<br />
どのような関係があるのか？
<ul>
<li>フラバノール:チョコ、ココア、赤ワインなどに含まれ、<br />
認知機能の低下を遅らせる、あるいは改善できることが報告</li>
</ul></li>
<li>「国民100万人当たりのノーベル賞受賞者数」を<br />
「国民に占める優れた認知機能を持つ人々の割合」に<br />
対する代表変数とみなし、チョコ消費量とノーベル賞<br />
受賞者数の相関関係は<strong>0.791</strong>(サンプルサイズ：23か国)
<ul>
<li>スウェーデンを除くと<strong>0.862</strong></li>
</ul></li>
</ul>
</section><section id="messerli2012のstudy-limitations" class="slide level2">
<h2>Messerli（2012）のStudy limitations</h2>
<div class="box">
<p>The present data are based on country averages, and the specific chocolate intake of individual Nobel laureates of the past and present remains unknown. The cumulative dose of chocolate that is needed to sufficiently increase the odds of being asked to travel to Stockholm is uncertain.</p>
</div>
<div class="box">
<p>Dr.Messerli reports regular daily chocolate consumption, mostly but not exclusively in the form of Lindt’s dark varieties.</p>
</div>
<ul>
<li>Messerli（2012）はユーモアを交えながら、<br />
安直なデータ解析への警告</li>
</ul>
</section><section id="筆者が考えるmesserli2012の警告" class="slide level2">
<h2>筆者が考えるMesserli（2012）の警告</h2>
<ul>
<li>因果推論に関して筆者は次の２点の警告がされていると考えた</li>
</ul>
<div class="box">
<ol type="1">
<li>2つの項目どうしに強い相関があると言っても、<br />
それが原因と結果の関係があることを結論づけない</li>
<li>高度情報化社会となった現在、IT技術を駆使すれば、興味ある項目と高い相関関係を有する項目を容易に<br />
発見できる</li>
</ol>
</div>
</section><section id="messerli2012で検討すべきデータ生成過程" class="slide level2">
<h2>Messerli（2012）で検討すべきデータ生成過程</h2>
<ol type="1">
<li>チョコ消費量がノーベル賞受賞者数に影響を与える</li>
<li>ノーベル賞受賞者数がチョコ消費量に影響を与える</li>
<li>チョコ消費量とノーベル賞受賞者数の間に共通の原因が存在</li>
</ol>
<ul>
<li>これらの可能性を検討するためにランダム化実験を<br />
すべきと主張</li>
</ul>
</section><section id="相関と因果" class="slide level2">
<h2>相関と因果</h2>
<ul>
<li>これまで関係がわからなかった項目間に弱い相関が<br />
あるとわかったとき
<ul>
<li>その関係は偶然的に生成されたと判断</li>
<li>「なぜ相関関係が弱いのか?」と因果関係を結び付けて判断することは少ない</li>
</ul></li>
<li>直感的に関係がないと思われていた項目間に強い相関があるとわかったとき
<ul>
<li>普遍的、つまり因果関係と解釈しようとする</li>
<li>行動を起こしやすい項目が原因、そうでない項目を結果と<br />
解釈しようとする人が少なくない</li>
<li>因果関係の正負と言った符号が相関関係と一致していると<br />
思い込む人もいる</li>
</ul></li>
</ul>
</section><section id="介入を伴わない観察研究において" class="slide level2">
<h2>介入を伴わない観察研究において</h2>
<ul>
<li>起こりうるケース
<ul>
<li>データから導かれた相関関係の有無が因果関係の有無と<br />
一致するとは限らない</li>
<li>相関関係はないが因果関係は存在する</li>
<li>相関関係が強くても因果関係は存在しない</li>
</ul></li>
<li>どちらが原因でどちらが結果であるかは問題設定に依存</li>
</ul>
</section><section id="messerli2012に触発された研究" class="slide level2">
<h2>Messerli（2012）に触発された研究</h2>
<ul>
<li>現在のIT技術を駆使すれば、ノーベル賞受賞者数と<br />
高い相関を持つ項目を探すことは難しくない
<ul>
<li>Maurage et al（2013）
<ul>
<li>ワイン、お茶、GDP、国民100万人あたりのIKEAの店舗数のそれぞれとノーベル賞受賞者数との相関係数を計算</li>
<li>国の経済力に関する項目がノーベル賞受賞者数と強い相関を持つ</li>
</ul></li>
<li>Linthwaite and Fuller（2013）
<ul>
<li>ミルク消費量とノーベル賞受賞者数の相関と、チョコ消費量とノーベル賞受賞者数の相関に大きな差異なし</li>
</ul></li>
<li>Doi et al（2014）
<ul>
<li>経済力よりも研究活動に関連する項目のほうがノーベル賞受賞者数の<br />
予測因子として優れている</li>
</ul></li>
</ul></li>
</ul>
</section><section id="強い相関がみられたとき" class="slide level2">
<h2>強い相関がみられたとき</h2>
<ul>
<li>強い相関がみられたときに考えられること
<ul>
<li>必然的か</li>
<li>偶然的か</li>
<li>与えられた状況に固有の知見か</li>
<li>広範囲に適用できる知見か</li>
</ul></li>
<li>単一の観察研究に基づいてこれらを判断することは困難</li>
<li>探索的に発見された知見が、我々にとって有用な情報かどうかは適用場面に依存
<ul>
<li>IKEAの店舗数とノーベル賞受賞者数に強い相関が認められた<br />
ことを根拠に、IKEAを誘致するように政府に働きかける？</li>
</ul></li>
</ul>
</section><section id="beer_diapers" class="slide level2">
<h2>1.4.2 おむつとビール　</h2>
<ul>
<li>紙おむつを買った人はビールを一緒に買う傾向がある
<ul>
<li>有名なデータマイニングの成功事例の1つ</li>
<li>米国中西部のある都市では、17時に紙おむつを購入した人は<br />
半ダースのビールも合わせて買う傾向</li>
<li>おつまみをおむつ棚の近くに配置したら、その時間帯のスナックの売り上げが17%増加</li>
</ul></li>
<li>これらの知見は<strong>「米国中西部のある都市」</strong>で<br />
得られたもの
<ul>
<li>他の都市や店舗で同じことが言えるかは当時「今後の課題」であり普遍的なものではない</li>
</ul></li>
</ul>
</section><section id="yamamoto" class="slide level2">
<h2>その後の実地調査（山本,2013）</h2>
<ul>
<li>データが採取された店舗の商圏に工場新設、<br />
若い家族層が移住</li>
<li>夫が仕事帰り（17時以降）におむつとビールを購入</li>
<li>この現象はこの店舗特有、一般におむつと併売確率が<br />
高いのはベビー用品</li>
<li>ポイントカードもない時代にデータがくっきりと<br />
その店舗の顧客像を浮かび上がらせたという意味で、<br />
データマイニングの成功事例</li>
</ul>
</section><section id="beer_diapers_cor" class="slide level2">
<h2>おむつとビールにおける相関と因果</h2>
<ul>
<li>観察研究によって得られた知見（米国中西部のある都市では…ビールもあわせて買う傾向がある）から<br />
「おむつの棚の近くに…17％増加した」という<br />
ストーリーを直接的に見出せない
<ul>
<li>前者はビールとおむつの購買の<strong>相関関係</strong>に基づく記述</li>
<li>「スナックの棚とおむつの棚の距離」について言及していない</li>
<li>後者は「おむつの棚の近くにスナックの棚を配置した」という販売戦略（外的操作）</li>
<li>前者は<strong>相関関係</strong>、後者は<strong>因果関係</strong></li>
</ul></li>
<li>相関情報だけで前者から後者を導くことは容易でない</li>
</ul>
</section><section id="相関が分かれば因果は分からなくて良い" class="slide level2">
<h2>相関が分かれば因果は分からなくて良い？</h2>
<ul>
<li>何の仮定・知見もなければビッグデータが因果関係を<br />
語ることはない</li>
<li>因果関係が分からなければ目的を達成するための行動を起こせない
<ul>
<li>その行動が有益かどうかも判断できない</li>
</ul></li>
<li>相関関係と因果関係の取り違えや因果の方向性に対する誤った思い込みが笑い話で済まされない社会問題や<br />
無駄な行動を誘発するのは稀なことではない（Gilovich,1993）
<ul>
<li>ノーベル賞受賞者数を増やすためにIKEAを誘致？</li>
</ul></li>
</ul>
</section></section>
<section><section id="問題意識" class="title-slide slide level1"><h1>1.5 問題意識</h1></section><section id="因果推論に関する主な課題holland1986" class="slide level2">
<h2>因果推論に関する主な課題（Holland,1986）</h2>
<div class="box">
<ol type="1">
<li>観察された因果関係に対する因果構造の解明</li>
<li>観察された因果関係における因果効果の定量的評価</li>
<li>観察された結果に対する原因の究明</li>
</ol>
</div>
<ul>
<li>興味ある変数XとYについて、XからYへの因果効果を<br />
定量的に評価することが重要</li>
</ul>
</section><section id="用語の導入" class="slide level2">
<h2>用語の導入</h2>
<ul>
<li>Y : 反応変数（response variable）or 結果変数（outcome variable）
<ul>
<li>Xの違いによって生じうる個体間の差異で興味の対象となる変数</li>
</ul></li>
<li>X : 処理変数（treatment variable）
<ul>
<li>個体間の差異を生じさせうる変数のうち興味の対象となる変数</li>
</ul></li>
<li>現実問題への応用を考えたとき、処理変数を曝露変数（exposure variable）や治療変数と呼ぶほうが<br />
ふさわしいケースもある
<ul>
<li>本書では基本的に処理変数で統一</li>
</ul></li>
</ul>
</section><section id="外的操作が可能か" class="slide level2">
<h2>外的操作が可能か</h2>
<ul>
<li>取り上げる変数が処理変数とみなせるか判断する際に<br />
検討</li>
<li>構造的因果モデルのフレームワークでは問題設定に依存
<ul>
<li>Causation before manipulation (Robins and Richardson,2010)</li>
</ul></li>
<li>︎処理変数と扱うことができるケース</li>
</ul>
<div class="box">
<ul>
<li>仮想的に外的操作可能か<br />
</li>
<li>「もしその項目が〇〇であったなら」といった<br />
<strong>反事実的</strong>（counterfactual）問題設定が可能か<br />
</li>
</ul>
</div>
<ul>
<li>潜在反応モデルのフレームワークでは、<br />
実際に外的操作が可能かどうかを議論の出発点に
<ul>
<li>No causation without manipulation (Holland,1986)</li>
</ul></li>
<li>因果関係を議論する上では構造的因果モデルの方が<br />
自由度が大きい</li>
</ul>
</section><section id="共変量と中間変数" class="slide level2">
<h2>共変量と中間変数</h2>
<ul>
<li>共変量（covariate）
<ul>
<li>処理変数の影響を受けない変数</li>
<li>付随変数（concomitant variable）や背景因子（background factor）とも呼ばれる</li>
<li>交絡因子は共変量の1つに分類</li>
</ul></li>
<li>中間変数（intermediate variable）
<ul>
<li>処理変数の影響を受け、かつ反応変数に影響を与える可能性のある変数</li>
</ul></li>
<li>興味ある変数集合を処理変数、反応変数、共変量、<br />
中間変数に区別することが因果推論を成功させる<br />
一つの鍵となる（宮川,2004a）
<ul>
<li>奥野他（1986）による事例を参考に考える</li>
</ul></li>
</ul>
</section><section id="about_Okuno" class="slide level2">
<h2>奥野他（1986）の概略</h2>
<ul>
<li>防錆性能と美観性能を付与するために行われる自動車のボディ塗装では塗装膜圧の確保が不可欠</li>
<li>塗装膜圧は下塗り・中塗り・上塗りの3層構成</li>
<li>中塗りと上塗りは塗料を作業者が吹き付けるため<br />
塗着率が悪いという問題<br />
➡︎塗装工程において塗着率が向上、安定する工程条件を設定するために様々な条件で実験（38組のデータ）
<ul>
<li>塗着率に影響を与える要因は希釈率、吐出量、湿度など<br />
10個の項目</li>
</ul></li>
</ul>
</section><section id="本書での設定" class="slide level2">
<h2>本書での設定</h2>
<ul>
<li>宮川,（2004a）や奥野他（1986）によると
<ul>
<li>希釈率は操作可能な処理変数</li>
<li>湿度は共変量、吐出量は中間変数であり操作は困難</li>
</ul></li>
<li>塗着率を反応変数とし、データ生成過程として<br />
線形構造方程式モデル（詳細は第5章）を仮定</li>
</ul>
</section><section id="適切な工程条件の設定とジレンマ" class="slide level2">
<h2>適切な工程条件の設定とジレンマ</h2>
<ul>
<li>適切な工程条件を設定するには、<strong>処理変数（希釈率）を操作した時の反応変数（塗着率）の分布状態を評価</strong></li>
<li>仮定なしに、「処理変数に対して我々が意図する操作を行っていない状況で得られたデータ」から<br />
「（実際まだ行っていない）処理変数を操作した時の<br />
反応変数の分布状態」を評価できるのか？</li>
<li>一方で、何かを知りたいならまずはそれを知るための<br />
行動を起こさなけれなばならない<br />
➡︎このジレンマを何とかできないか？</li>
</ul>
</section><section id="仮定" class="slide level2">
<h2>仮定</h2>
<ul>
<li>以下の相関行列が得られた</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">希釈率</th>
<th style="text-align: center;">吐出量</th>
<th style="text-align: center;">湿度</th>
<th style="text-align: center;">塗着率</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>希釈率</strong></td>
<td style="text-align: center;">1.0000</td>
<td style="text-align: center;">0.3379</td>
<td style="text-align: center;">-0.4958</td>
<td style="text-align: center;">0.2456</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>吐出量</strong></td>
<td style="text-align: center;">0.3379</td>
<td style="text-align: center;">1.0000</td>
<td style="text-align: center;">-0.1216</td>
<td style="text-align: center;">-0.0133</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>湿度</strong></td>
<td style="text-align: center;">-0.4958</td>
<td style="text-align: center;">-0.1216</td>
<td style="text-align: center;">1.0000</td>
<td style="text-align: center;">-0.5402</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>塗着率</strong></td>
<td style="text-align: center;">0.2456</td>
<td style="text-align: center;">-0.0133</td>
<td style="text-align: center;">-0.5402</td>
<td style="text-align: center;">-1.0000</td>
</tr>
</tbody>
</table>
<ul>
<li>湿度は希釈率と塗着率に対して十分な交絡因子（sufficient confounder）
<ul>
<li>古典的な逐次的線形回帰分析のフレームワークで<br />
データ生成過程が表現できる</li>
</ul></li>
<li>希釈率と塗着率の相関係数は0.246と正の値<br />
➡︎希釈率を大きくすれば塗着率も向上する？？</li>
</ul>
</section><section id="reg1" class="slide level2">
<h2>塗着率を目的変数とした線形回帰分析1</h2>
<ul>
<li>希釈率、吐出量、湿度を説明変数とする
<div class="box">
<p>塗着率 = 0.000 × 希釈率 -0.080 × 吐出量 -0.550 × 湿度</p>
</div></li>
<li>希釈率を操作しても工程改善に役立たない？</li>
<li>吐出量を操作した方が良い？</li>
</ul>
</section><section id="reg2" class="slide level2">
<h2>塗着率を目的変数とした線形回帰分析2</h2>
<ul>
<li>希釈率、湿度を説明変数とする<br />

<div class="box">
<p>塗着率 = -0.029 × 希釈率 -0.555 × 湿度</p>
</div></li>
<li>希釈率、吐出量を説明変数とする<br />

<div class="box">
<p>塗着率 = 0.282 × 希釈率 -0.109 × 吐出量</p>
</div></li>
<li>それぞれのモデルで希釈率の係数の正負が異なる<br />
➡︎どの解析結果を信頼し、希釈率にどのような操作を<br />
行えば良いか？</li>
</ul>
</section><section id="伝統的な線形回帰分析のフレームワーク" class="slide level2">
<h2>伝統的な線形回帰分析のフレームワーク</h2>
<ul>
<li>処理変数、中間変数、共変量が同じ説明変数として<br />
平等に扱われる</li>
<li>機械的な変数選択によって
<ul>
<li>処理変数が解析から取り除かれる</li>
<li>処理変数の回帰係数の符号が大きく変わる</li>
</ul></li>
<li>変数選択の目的は予測モデルのシンプルさと<br />
予測精度の向上
<ul>
<li>真のデータ生成過程の解明や因果効果の評価を<br />
目的としていない</li>
</ul></li>
</ul>
</section><section id="有効グラフで記述" class="slide level2">
<h2>有効グラフで記述</h2>
<ul>
<li>希釈率と塗着率に関して、湿度がバックドア基準を<br />
満たすことを確認（詳細は第3.7.2項）</li>
<li>希釈率と湿度を説明変数、塗着率を目的変数とした<br />
回帰分析から</li>
</ul>
<div class="box">
<p>希釈率を操作して1単位当たり増加させると<br />
塗着率の期待値は0.029減少する</p>
</div>
<ul>
<li>この結果より
<ul>
<li>相関係数をみて希釈率を操作し増加させると塗着率は低下</li>
<li>塗着率を向上させるために希釈率を操作することは<br />
無意味でない<br />
</li>
</ul></li>
<li>※因果効果を評価するために用いられる統計モデルが<br />
予測モデルとして優れているわけではない</li>
</ul>
</section><section id="one_of_Purpose" class="slide level2">
<h2>因果推論が目的とするものの1つ</h2>
<div class="box">
<p>単なる統計的予測問題を超えて、興味ある因果的尺度を適切に評価するためにどのような変数を観測すれば<br />
良いのか、観測できない場合にはどのような代替案が<br />
あるのか、といった<strong>解析方針を与えること</strong></p>
</div>
</section></section>
    </div>
  </div>

  <script src="Kuroki_01_files/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="Kuroki_01_files/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display the page number of the current slide
        slideNumber: 'c/t',
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Transition style
        transition: 'default', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom



        chalkboard: {
          theme: 'whiteboard',
        },

        keyboard: {
          67: function() { RevealChalkboard.toggleNotesCanvas() },    // toggle notes canvas when 'c' is pressed
          66: function() { RevealChalkboard.toggleChalkboard() }, // toggle chalkboard when 'b' is pressed
          46: function() { RevealChalkboard.clear() },    // clear chalkboard when 'DEL' is pressed
           8: function() { RevealChalkboard.reset() },    // reset chalkboard data on current slide when 'BACKSPACE' is pressed
          68: function() { RevealChalkboard.download() }, // downlad recorded chalkboard drawing when 'd' is pressed
        },

        // Optional reveal.js plugins
        dependencies: [
          { src: 'Kuroki_01_files/reveal.js-3.3.0.1/plugin/chalkboard/chalkboard.js', async: true },
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
